<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Cagatay Dursun, Jake Petrie, Serdar Bozdag" />


<title>PhenoGeneRanker</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">PhenoGeneRanker</h1>
<h4 class="author">Cagatay Dursun, Jake Petrie, Serdar Bozdag</h4>
<h4 class="date">7/15/2020</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(PhenoGeneRankerPackage)</a></code></pre></div>
<div id="table-of-contents" class="section level1">
<h1>Table of Contents</h1>
<ul>
<li><a href="#Introduction">Introduction</a></li>
<li><a href="#Using-the-Methods">Using the Methods</a>
<ul>
<li><a href="#Input-File-Formatting">Input File Formatting</a><br />
</li>
<li><a href="#CreateWalkMatrix">CreateWalkMatrix</a><br />
</li>
<li><a href="#randomwalkrestart">RandomWalkRestart</a><br />
</li>
</ul></li>
<li><a href="#Example-Workflow">Example Workflow</a></li>
<li><a href="#Summary">Summary</a></li>
<li><a href="#Acknowledgements">Acknowledgements</a></li>
</ul>
<div id="introduction" class="section level2">
<h2><a id="Introduction"></a> Introduction</h2>
<p>PhenoGeneRanker is a gene and phenotype prioritization tool that utilizes a heterogeneous gene-phenotype network. PhenoGeneRanker allows multi-layer gene and disease networks. It also calculates empirical p-values of gene ranking using random stratified sampling of genes based on their connectivity degree in the network.</p>
</div>
</div>
<div id="load-phenogeneranker" class="section level1">
<h1>Load PhenoGeneRanker</h1>
<p>Loading the package will make it usable and check to make sure that all of the nessecary packages are also installed.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(PhenoGeneRankerPackage)</a></code></pre></div>
<div id="using-the-methods" class="section level2">
<h2><a id="Using-the-Methods"></a> Using the Methods</h2>
<ul>
<li>CreateWalkMatrix</li>
<li>randomwalkrestart</li>
</ul>
</div>
<div id="input-file-formatting" class="section level2">
<h2><a id="Input-File-Formatting"></a> Input File Formatting</h2>
<p>The CreateWalkMatrix method takes in an <em>input file</em> as a parameter. This file is a “.txt” file with two tab-separated columns which hold the data files you would like to work with. The header row must say “type” and “file_name” for each of the two columns. The type column contains what kind of data is stored in the file. These can be either gene, phenotype, or bipartite file types. The file_name column stores the name of your data file along with the “.txt” extension.</p>
<p>This file should look something like this:</p>
<pre><code>type    file_name  
gene    geneFile1.txt 
gene    geneFile2.txt
phenotype    phenotypeFile1.txt  
phenotype    phenotypeFile2.txt
bipartite    bipartiteFile.txt  </code></pre>
<p>Inside each of the file_name files, there is a “from”, “to”, and “weight” column. These are all tab-separated. For the gene and phenotype files, the “from” and “to” columns will contain the names of the genes and phenotypes, the row order doesn’t matter. The “weight” column will have the weight of the relationship between the genes and phenotypes. All unweighted networks must have a value of 1 in the weight column. For the bipartite file, the “from” column must contain gene names and the “to” column must have phenotype names. The meaning and usage of the weight column are analogous to the gene and phenotype files.</p>
<p>The geneFile1.txt from the previous example could look like this:</p>
<pre><code>from     to       weight  
gene1    gene2    1  
gene1    gene3    1  
gene2    gene4    1 
...      ...      ...</code></pre>
<p>The phenotype files could look like this:</p>
<pre><code>from     to       weight  
pheno1   pheno2   1  
pheno1   pheno3   1  
pheno3   pheno5   1  
...      ...      ...</code></pre>
<p>The bipartite file would look like this:</p>
<pre><code>from     to        weight  
gene1    pheno1    1  
gene2    pheno2    1 
...      ...       ...</code></pre>
</div>
<div id="createwalkmatrix" class="section level2">
<h2><a id="CreateWalkMatrix"></a> CreateWalkMatrix</h2>
<p>This method generates a walk matrix from gene and phenotype data. It takes in an <em>input-file name</em> as a parameter. It has to be a ‘.txt’ file. Instructions on how to format the input file and the necessary data files can be found in the <a href="#Input-File-Formatting">input file formatting</a> section above.</p>
<p>The rest of the parameters are useful if you would like to alter your resulting matrix. The parameter <em>numCores</em> is the number of cores used for parallel processing, it defaults to a value of 1. It is recommended to use detectCores() for this parameter. The parameter <em>delta</em> is the probability of jumping between gene layers. It has a range of 0 to 1 and a default value of 0.5. The parameter <em>zeta</em> is the probability of jumping between gene layers. It has a range of 0 to 1 and a default value of 0.5. The parameter <em>lambda</em> is the inter-network jump probability. It has a range of 0 to 1 and a default value of 0.5.</p>
<p>The returned list is what will be used in the randomwalkrestart() method.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">walkMatrix &lt;-<span class="kw">CreateWalkMatrix</span>(<span class="st">&#39;file.txt&#39;</span>)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">CreateWalkMatrix</span>(<span class="st">&#39;file.txt&#39;</span>, <span class="kw">detectCores</span>(), <span class="fl">0.4</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>)</a></code></pre></div>
<p>This method returns a list containing the walk matrix, a sorted list of gene pool nodes, a sorted list of phenotype pool nodes, the connectivity of the genes, the connectivity of the phenotypes the number of genes, the number of phenotypes, the number of gene pool nodes, and the number of phenotype pool nodes. You can access these elements as shown below.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">walkMatrix[[“WM”]] <span class="co"># accesses the walk matrix itself</span></a>
<a class="sourceLine" id="cb8-2" title="2">walkMatrix[[“genes”]] <span class="co"># accesses the sorted gene pool nodes</span></a>
<a class="sourceLine" id="cb8-3" title="3">walkMatrix[[“phenotypes”]] <span class="co"># accesses the sorted phenotype pool nodes</span></a>
<a class="sourceLine" id="cb8-4" title="4">walkMatrix[[“gene_connectivity”]] <span class="co"># accesses the degree of all the genes in the network</span></a>
<a class="sourceLine" id="cb8-5" title="5">walkMatrix[[“phenotype_connectivity”]] <span class="co"># accesses the degree of all the phenotypes in the network</span></a>
<a class="sourceLine" id="cb8-6" title="6">walkMatrix[[“LG”]] <span class="co"># the number of genes in the network</span></a>
<a class="sourceLine" id="cb8-7" title="7">walkMatrix[[“LP”]] <span class="co"># the number of phenotypes in the network</span></a>
<a class="sourceLine" id="cb8-8" title="8">walkMatrix[[“N”]] <span class="co"># the number of gene pool nodes</span></a>
<a class="sourceLine" id="cb8-9" title="9">walkMatrix[[“M”]] <span class="co"># the number of phenotype pool nodes</span></a></code></pre></div>
</div>
<div id="randomwalkrestart" class="section level2">
<h2><a id="randomwalkrestart"></a> RandomWalkRestart</h2>
<p>This method runs the random walk with restart on the provided walkmatrix transition matrix of multiplex heterogeneous networks. When random walk converges to steady state then the random walk stops. If the parameter generatePvalue is FALSE, it returns a data frame including gene and phenotype names, ranks and steady state scores of the genes and phenotypes. If generatePvalue is TRUE then it generates p-values along with the ranks with respect to offset value of 100.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">RWR &lt;-<span class="st"> </span><span class="kw">RandomWalkRestart</span>(walkMatrix, <span class="kw">c</span>(<span class="st">&#39;gene1&#39;</span>, <span class="st">&#39;gene2&#39;</span>), <span class="kw">c</span>(), <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-2" title="2">RWR &lt;-<span class="st"> </span><span class="kw">RandomWalkRestart</span>(<span class="kw">CreateWalkMatrix</span>(<span class="st">&#39;myFile.txt&#39;</span>),<span class="kw">c</span>(<span class="st">&#39;gene1&#39;</span>), <span class="kw">c</span>(<span class="st">&#39;phenotype1&#39;</span>, <span class="st">&#39;phenotype2&#39;</span>), <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb9-3" title="3">RWR &lt;-<span class="st"> </span><span class="kw">RandomWalkRestart</span>(<span class="kw">CreateWalkMatrix</span>(<span class="st">&#39;myFile.txt&#39;</span>),<span class="kw">c</span>(<span class="st">&#39;gene1&#39;</span>), <span class="kw">c</span>(), <span class="ot">TRUE</span>, <span class="dv">12</span>, <span class="fl">0.7</span>, <span class="fl">0.6</span>, “tau”=(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="fl">1.5</span>), “phi”=(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="fl">1.5</span>))</a></code></pre></div>
<p>If the generatePvalues parameter is TRUE, the resulting data frame looks like this.</p>
<pre><code>gene    score     P100
g1      1.9e-3    0.020000000
g425    1.6e-3    0.030000000
g77     1.3e-3    0.120000000
...     ...       ...</code></pre>
<p>If the generatePvalues parameter is FALSE, the resulting data frame looks like this.</p>
<pre><code>gene    score
gene47  8.877424e-04
gene202 8.219792e-04
gene33  5.779120e-04
...     ...     ...</code></pre>
<p>Due to the nature of this method, it can return a different output depending on the “generatePvalue” parameter. If the parameter “generatePValue” is TRUE, then this method returns a rank sorted data frame with three columns for the gene name, score, p-value. If “generatePValue” is FALSE, then it creates a data frame of all of the genes ranked. It has a column of the rank, gene name, and random walk scores for each gene or phenotype.</p>
</div>
<div id="example-workflow" class="section level2">
<h2><a id="Example-Workflow"></a> Example Workflow</h2>
<p>It is recommended that you should run these two methods one after another.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">walkMatrix &lt;-<span class="kw">CreateWalkMatrix</span>(<span class="st">&#39;file.txt&#39;</span>)</a>
<a class="sourceLine" id="cb12-2" title="2">rwr &lt;-<span class="kw">randomwalkrestart</span>(walkMatrix, <span class="kw">c</span>(<span class="st">&#39;gene1&#39;</span>, <span class="st">&#39;gene2&#39;</span>), <span class="kw">c</span>(), <span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="summary" class="section level2">
<h2><a id="Summary"></a> Summary</h2>
<p>This package was originally created for a gene prioritization project. It was performed with datasets from rice genes. You can read the paper about this project here. <a href>PhenoGeneRankerPaper</a></p>
</div>
<div id="acknowledgements" class="section level2">
<h2><a id="Acknowledgements"></a> Acknowledgements</h2>
<p>package specific</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
